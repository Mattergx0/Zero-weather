<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#007AFF">
    <title>ZeroWeather</title>
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="icon.png">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Welcome Screen -->
    <div id="welcome-screen" class="active">
        <h1>Welcome to</h1>
        <img src="icon.png" alt="Zero Weather Logo" class="welcome-logo">
        <h2>Zero Weather</h2>
    </div>

    <!-- Loading screen -->
    <div class="loading" id="loading">
        <div class="spinner"></div>
        <p>Gegevens laden...</p>
    </div>

    <!-- Home Pagina -->
    <div id="home-page" class="page">
        <header class="weather-header">
            <div class="search-container">
                <input type="text" id="search-input" placeholder="Zoek locatie...">
                <button onclick="searchLocation()">üîç</button>
            </div>
        </header>

        <!-- ... (zelfde weer content als voorheen) ... -->
    </div>

    <!-- Map Pagina -->
    <div id="map-page" class="page">
        <div class="map-container">
            <div id="map"></div>
            <div class="map-overlay">
                <span class="rain-legend">üåßÔ∏è Regenintensiteit</span>
            </div>
        </div>
        <button class="nav-button" onclick="showPage('home-page')">Terug naar weer</button>
    </div>

    <script>
        // Welcome screen logic
        setTimeout(() => {
            document.getElementById('welcome-screen').classList.remove('active');
        }, 2000);

        // Aangepaste map initialisatie
        function initMap(lat, lon) {
            if(map) map.remove();
            
            map = L.map('map').setView([lat, lon], 8);
            
            // Basis kaartlaag
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '¬© OpenStreetMap'
            }).addTo(map);

            // Regenradar laag
            L.tileLayer(`https://tile.openweathermap.org/map/precipitation_new/{z}/{x}/{y}.png?appid=${API_KEY}`, {
                opacity: 0.6,
                attribution: 'Rain data ¬© OpenWeatherMap'
            }).addTo(map);

            // Locatie marker
            L.marker([lat, lon]).addTo(map)
                .bindPopup('Huidige locatie')
                .openPopup();
        }

        // Zoekfunctie aanpassing
        async function searchLocation() {
            const input = document.getElementById('search-input');
            toggleLoading(true);
            
            try {
                const response = await fetch(
                    `https://api.openweathermap.org/geo/1.0/direct?q=${input.value}&limit=1&appid=${API_KEY}`
                );
                const data = await response.json();
                if(data.length > 0) {
                    const lat = data[0].lat;
                    const lon = data[0].lon;
                    
                    getWeather(lat, lon);
                    initMap(lat, lon);
                    
                    // Pan naar nieuwe locatie
                    map.setView([lat, lon], 10);
                    L.marker([lat, lon]).addTo(map)
                        .bindPopup(`Gevonden locatie: ${data[0].name}`)
                        .openPopup();
                }
            } catch (error) {
                console.error('Zoekfout:', error);
            } finally {
                toggleLoading(false);
            }
        }
    </script>
</body>
</html>
